🎯 {{ profile.role }}

{% set report_type = profile.get_config().get("report_type", "company") %}
{% if report_type == "company" %}
🏢 目标公司：{{ profile.get_identity() }}
{% elif report_type == "industry" %}
🏭 目标行业：{{ profile.get_config().get("industry", "未指定行业") }}
{% elif report_type == "macro" %}
🌍 分析区域：{{ profile.get_config().get("country", "中国") }}
{% endif %}

🧠 当前任务目标：
{{ task }}

📌 已完成步骤：{{ completed | join(", ") if completed else "无" }}
❌ 执行失败步骤：{{ failed | join(", ") if failed else "无" }}

📄 当前上下文信息摘要：
{% for k, v in context.items() %}
【{{ k }}】
{% if v is string %}
{{ v[:300] }}
{% else %}
[结构化数据]
{% endif %}

{% endfor %}

{% if report_type == "company" %}
💡 提示：请优先执行数据收集任务（竞争对手分析、财务数据获取），然后进行分析任务。
{% elif report_type == "industry" %}
💡 提示：请优先收集行业概况、产业链、政策影响等基础数据，然后进行行业结构和趋势分析。
{% elif report_type == "macro" %}
💡 提示：请优先收集宏观经济指标（GDP、CPI、利率等）和政策数据，然后进行趋势和影响分析。
{% endif %}

请根据任务和上下文，判断下一步应调用哪个函数（只返回函数名），若任务已完成请返回 `done`。
